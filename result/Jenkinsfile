pipeline {
    agent any 
    
    tools {
        nodejs 'Node 8.9.0' 
          }

    stages {
        stage('build') 
        {
            when 
              { 
               changeset "**/result/**" 
              }
            steps {
                echo 'Compiling result app'
                dir('result')
                { sh 'npm install' }
                  }
        }
        
        stage('test') 
        {

            when 
              { 
               changeset "**/result/**" 
              }

            steps {
                echo 'Running unit tests for results app'
                dir('result')
                { sh 'npm test' }
                   }
        }
        

           }

           
        
    post { 
        always { 
                echo 'Results pipeline is complete'
               }
        failure {
                 slackSend (channel: "ci-cd" , message: "Build Failure - ${env.JOB_NAME} ${env.BUILD_NUMBER} (<${env.BUILD_URL}|Open>)")
                }
        success {
                 slackSend (channel: "ci-cd" , message: "Build Success - ${env.JOB_NAME} ${env.BUILD_NUMBER} (<${env.BUILD_URL}|Open>)")
                }
         }  
} 
